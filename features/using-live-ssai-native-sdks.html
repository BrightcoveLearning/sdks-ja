---
title: 'ネイティブSDKでのライブSSAIの使用' 
description: このトピックでは、Brightcove Native SDKを使用して、サーバー側の広告挿入（SSAI）が有効になっているライブストリームを再生する方法を学習します。
parent: Live 
grandparent: Androidの開発
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概要</h2>

<p>サーバー側の広告挿入（<span translate="No"> SSAI</span>）広告をビデオコンテンツストリームにつなぎ合わせて、テレビのような視聴体験を提供できます。ネイティブ SDK でライブストリームを再生するには、ビデオリクエストとともに再生トークンを渡す必要があります。</p>

<p>住む<span translate="No">SSAI</span>次のことが可能になります。</p>

<ul>
	<li>エンコーダから送信されたキューポイントを使用して広告を挿入するか、を使用してインスタントキューポイントを作成します<span translate="No">ライブAPI</span></li>
	<li>「スレート」アセットを取り込み、未使用の広告時間を埋める</li>
	<li>サーバー側のライブストリームに縫い付けられた広告で広告ブロッカーを避ける</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Steps">ステップ</h2>

<p>でライブストリームを再生するには<span translate="No">SSAI</span>、 次の手順を実行します：</p>

<ol class="bcls-tasklist-restart">
	<li>Video Cloud <a href="https://studio.support.brightcove.com/admin/configuring-server-side-ad-settings.html#Creating_a_Live_ad_configuration"> Studioを使用してライブ広告設定を作成する</a></li>
	<li>オプション:<a href="https://live.support.brightcove.com/live-module/implementing-server-side-ads-live-module.html#fill_slate">スレートアセットの作成</a>、<a href="https://live.support.brightcove.com/live-api/ssai/live-api-cue-points-and-ad-beacons-ssai.html">キューポイントと広告ビーコンの挿入</a></li>
	<li><a href="#Create_a_live_event">ライブイベントを作成する</a></li>
	<li><a href="#Get_the_playback_token">再生トークンを取得する</a></li>
	<li>
	<p>アプリを構築する:</p>

	<ul>
		<li><a href="#Android_implementation">Androidの実装</a></li>
		<li><a href="#iOS_implementation">iOSの実装</a></li>
		<!-- <li><a href="#tvOS_implementation">tvOS implementation</a></li> -->
	</ul>
	</li>
	<li><a href="https://live.support.brightcove.com/live-module/implementing-server-side-ads-live-module.html#Requesting_an_ad">広告中断をリクエストする</a></li>
</ol>

<aside class="bcls-aside bcls-aside--tip">必要に応じて、Live APIを使用してストリームを作成し、広告休憩を構成できます。詳細については、<a href="https://live.support.brightcove.com/live-api/ssai/live-api-server-side-ad-insertion-ssai.html">ライブ API を参照してください。サーバーサイド広告挿入（SSAI）</a>資料。</aside>
</section>

<section class="bcls-section">
<h2 id="Create_a_live_event">ライブイベントを作成する</h2>

<p>デフォルトでは、ライブストリームはBrightcove CDN を使用します。ご希望の場合は、CDN（BYO CDN または「独自の帯域幅を持参」）の独自選択を使用できます。独自の CDN を使用するには、このセクションと [ <a href="#Get_the_playback_token">再生トークンの取得</a> ] セクションにオプションの手順を含めます。</p>

<p>ライブイベントを作成するには、次の手順に従います。</p>

<ol class="bcls-tasklist-restart">
	<li><a href="https://live.support.brightcove.com/live-module/implementing-server-side-ads-live-module.html#create_event">Live Module ドキュメントの「サーバーサイド広告の実装」</a>を参照してください。</li>
  <li>を展開します<strong>高度なオプション</strong>セクション。</li>
	<li>
    <p>選択する<strong>サーバーサイド広告挿入（SSAI）を有効にする</strong>、およびを選択します<strong>スレートを埋める</strong>。</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Enable SSAI" src="/assets/images/features/live-ssai/enable-ssai.png" />
      <figcaption class="bcls-caption--image">SSAI を有効にする</figcaption>
      </figure>
  </li>
	<li>
	<p><strong>オプション</strong> :独自の CDN を使用するには、次の追加手順を含めます。</p>
	<ul>
		<li>
		<p>の中に<strong>高度なオプション</strong>セクションで、<strong>マルチCDN構成を追加する</strong>オプション。</p>

		<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Multi CDN Configuration" src="/assets/images/features/live-ssai/add-cdn.png" />
		<figcaption class="bcls-caption--image">マルチ CDN の設定</figcaption>
		</figure>
		</li>
		<li>
      <p>自分の CDN のラベルと URL を入力します。詳細については、<a href="https://studio.support.brightcove.com/general/content-delivery-options.html">コンテンツ配信オプション</a>資料。</p>
      <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Add label and URL" src="/assets/images/features/live-ssai/add-label-and-url.png" />
      <figcaption class="bcls-caption--image">ラベルとURLを追加する</figcaption>
      </figure>
    </li>
	</ul>
	</li>
  <li>
    ライブイベントの設定が完了したら、をクリックします<strong>イベントの作成</strong>。
  </li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Get_the_playback_token">再生トークンを取得する</h2>

<p>ライブストリームで SSAI を有効にすると、<code translate="No">adConfigId</code>プレーヤーの埋め込みコードにパラメーターが含まれます。この値は、アプリで動画コンテンツをリクエストするときに使用する再生トークンです。</p>

<p>再生トークンを取得するには、次の手順を実行します。</p>

<ol class="bcls-tasklist-restart">
	<li>Video Cloud Studioで、に戻ります。<strong>住む</strong>モジュール。</li>
	<li>左側のナビゲーションで、<strong>公開して埋め込む</strong>。</li>
	<li>
    <p>の中に<strong>ライブプレーヤーオプション</strong>セクションを展開し、<strong>広告設定を選択</strong>オプションを選択し、前の手順で作成したライブ広告構成を選択します。</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Select Ad Configuration" src="/assets/images/features/live-ssai/select-ad-config.png" />
    <figcaption class="bcls-caption--image">広告設定を選択</figcaption>
    </figure>
	</li>
  <li>
    <p><a href="">標準埋め込みコードをクリップボードにコピーします</a>。</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Embed code" src="/assets/images/features/live-ssai/embed-code.png" />
    <figcaption class="bcls-caption--image">埋め込みコード</figcaption>
    </figure>
	</li>
	<li>
	  <p>埋め込みコードから、<code translate="No">VideoId</code>パラメータ値。この値は後のステップで使用します。これは次のようになります。</p>
	<pre>
<code class="language-html" translate="No">1700044540369289748</code></pre>
	</li>
  <li>
	  <p>埋め込みコードから、<code translate="No">adConfigId</code>パラメータ値。この値は後のステップで使用します。<code translate="No">adConfigId</code>この値は、Video Cloud ライブラリからコンテンツをリクエストするときに渡される再生トークンです。これは次のようになります。</p>
	<pre>
<code class="language-html" translate="No">live.t0vbpNIjTPW6IZ29QsyuWrmgjvQjEWe3u_wPmaMqnhAmE05DCF7aAa-6fDIkvryJctH1rADJnfXYANy7tDg4agQFx23WIvsXMmAjz1BiNl-S3rFZ9tRdzRWdo1E4FTLkET6XcNuNZ2acTnzmow</code></pre>
	</li>
	<li>また、アカウントのアカウント ID とポリシーキーも必要です。</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Android_implementation">Androidの実装</h2>

<p>ライブストリームを再生するには、<code translate="No">adConfigId</code>パラメーターと再生トークンの値をビデオリクエストに含めます。</p>

<p>アプリを構築するには、次の手順に従います。</p>

<ol class="bcls-tasklist-restart">
	<li><a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicSsaiSampleApp">基本的な SSAIサンプルアプリをコードの出発点として使用します</a>。</li>
	<li><strong>res/values/strings.xml </strong>ファイルで、次の値を独自の値に置き換えます
	<ul>
		<li>アカウント ID</li>
    <li>ポリシーキー</li>
		<li>ビデオID（から<a href="#Get_the_playback_token">再生トークンを取得する</a>上記のセクション）</li>
	</ul>
	</li>
	<li>
	<p>の中に<strong>MainActivity.java</strong>ファイル、を置き換えます<code translate="No">ad_config_id</code>のライブモジュールからコピーした再生トークン（ライブURL）の値<a href="#Get_the_playback_token">再生トークンを取得する</a>上記のセクション。</p>
	<pre>
<code class="language-java" translate="No">private final String AD_CONFIG_ID_QUERY_PARAM_VALUE = "live.t0vbpNIjTPW6IZ29QsyuWrmgjvQjEWe3u_wPmaMqnhAmE05DCF7aAa-6fDIkvryJctH1rADJnfXYANy7tDg4agQFx23WIvsXMmAjz1BiNl-S3rFZ9tRdzRWdo1E4FTLkET6XcNuNZ2acTnzmow";</code></pre>
	</li>
	<li>
	<p>再生トークンの値がクエリパラメータとして HTTP リクエストに追加されます。<code translate="No">ad_config_id</code></p>

	<pre class="line-numbers">
<code class="language-java" translate="No">HttpRequestConfig httpRequestConfig = new HttpRequestConfig.Builder()
  .addQueryParameter(AD_CONFIG_ID_QUERY_PARAM_KEY, AD_CONFIG_ID_QUERY_PARAM_VALUE)
  .build();
</code></pre>
	</li>
	<li>
	<p>ライブストリーム動画 ID と更新された HTTP リクエストを使用して、Playback API へのカタログ呼び出しを行います。</p>

	<pre class="line-numbers">
<code class="language-java" translate="No">catalog.findVideoByID(getString(R.string.video_id), httpRequestConfig, new VideoListener() {
   @Override
   public void onVideo(Video video) {
       plugin.processVideo(video);
   }
 });
</code></pre>
	</li>
	<li>
	<p>アプリはライブストリームを再生する準備ができました。</p>

	<p>Android 版ネイティブ SDK で SSAI で有効なライブストリームを使用する方法の詳細については、<a href="https://www.brightcove.com/en/blog/2019/12/ssai-plugin-changes-690"> 6.9.0 のブログ記事の「SSAI プラグインの変更点</a>」を参照してください。</p>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="iOS_implementation">iOSの実装</h2>

<p>ライブストリームを再生するには、<code translate="No">adConfigId</code>パラメーターと再生トークンの値をビデオリクエストに含めます。</p>

<p>アプリを構築するには、次の手順に従います。</p>

<ol class="bcls-tasklist-restart">
	<li><a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/SSAI/BasicSSAIPlayer">基本的な SSAIサンプルアプリをコードの出発点として使用します</a>。</li>
	<li><strong>ViewController.swift </strong>ファイルで、以下を独自の値に置き換えます
	<ul>
		<li>アカウント ID</li>
    <li>ポリシーキー</li>
		<li>ビデオID（から<a href="#Get_the_playback_token">再生トークンを取得する</a>上記のセクション）</li>
	</ul>
	</li>
	<li>
	<p>の中に<strong>ViewController.swift</strong>ファイル、を置き換えます<code translate="No">AdConfigId</code>のライブモジュールからコピーした再生トークン（ライブURL）の値<a href="#Get_the_playback_token">再生トークンを取得する</a>上記のセクション。</p>

	<pre>
<code class="language-swift" translate="No">static let AdConfigId = "live.t0vbpNIjTPW6IZ29QsyuWrmgjvQjEWe3u_wPmaMqnhAmE05DCF7aAa-6fDIkvryJctH1rADJnfXYANy7tDg4agQFx23WIvsXMmAjz1BiNl-S3rFZ9tRdzRWdo1E4FTLkET6XcNuNZ2acTnzmow";</code></pre>
	</li>
	<li>
	<p>再生トークンの値がクエリパラメータとして HTTP リクエストに追加されます。<code translate="No">AdConfigId</code></p>

	<pre class="line-numbers">
<code class="language-swift" translate="No">let queryParameters = [kBCOVPlaybackServiceParamaterKeyAdConfigId: Constants.AdConfigId]
</code></pre>
	</li>
	<li>
	<p>ライブストリーム動画 ID と更新された HTTP リクエストを使用して、Playback API へのカタログ呼び出しを行います。</p>

	<pre class="line-numbers">
<code class="language-swift" translate="No">playbackService.findVideo(withVideoID: Constants.VideoId, parameters: queryParameters) { [weak self] (video: BCOVVideo?, jsonResponse: [AnyHashable: Any]?, error: Error?) -&gt; Void in

   guard let _video = video else {
     print("ViewController Debug - Error retrieving video: \(error?.localizedDescription ?? "unknown error")")
     return
   }

   self?.playbackController?.setVideos([_video] as NSFastEnumeration)
}
</code></pre>
	</li>
	<li>アプリはライブストリームを再生する準備ができました。</li>
</ol>
</section>
</article>