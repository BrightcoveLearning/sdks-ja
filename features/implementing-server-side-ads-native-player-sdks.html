---
title: 'ネイティブSDKを使用したサーバーサイド広告の実装' 
description: このトピックでは、動的配信用に取り込まれた動画から、Brightcove Native PlayerSDKを使用してサーバーサイド広告を再生する方法を学習します。
parent: Features 
grandparent: Home
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概要</h2>

<p>サーバーサイド広告挿入（SSAI）を使用すると、動画に広告を埋め込むことで、ブラウザーの広告ブロッカーによってブロックされないようにすることができます。動的配信は、ストレージフットプリントを削減し、メディアを動的にパッケージングする次世代の取り込みおよび配信システムです。<a href="https://studio.support.brightcove.com/general/overview-dynamic-delivery.html">動画に動的配信を使用する方法について詳しくは</a>、こちらをご覧ください。</p>

<p>SSAI は DRM コンテンツと DRM 以外のコンテンツの両方で動作します。</p>

<aside class="bcls-aside bcls-aside--information">注意:
<ul>
	<li>SSAI を使用するには、Video Cloud <a href="https://studio.support.brightcove.com/general/overview-dynamic-delivery.html">アカウントをダイナミック配信に設定し</a>、SSAI を有効にする必要があります。この機能の使用を開始するには、アカウントマネージャーにお問い合わせください。</li>
	<li>SSAI はビデオオンデマンド (VOD) で動作し、ライブ再生をサポートしています。</li>
	<li>制限事項のリストについては、「<a href="https://ssai.support.brightcove.com/getting-started/video-cloud-ssai-overview.html#Limitations"> SSAI の概要</a>」ドキュメントを参照してください。</li>
</ul>
</aside>

<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Server-side ad" src="/assets/images/android/ssai/ssai-sdk.png" />
<figcaption class="bcls-caption--image">サーバーサイド広告</figcaption>
</figure>

<p>動的配信で取り込んだ動画には、VMAP ファイルで指定された広告が広告設定に含まれます。</p>

<p>Video Cloud に保存されている動画コンテンツを使用してサーバーサイド広告を再生するには、次の手順に従います。</p>

<ol class="bcls-tasklist">
	<li><a href="#Create_an_ad_configuration">広告設定を作成する</a></li>
	<li>
	<p>アプリを構築する:</p>

	<ul>
		<li><a href="#Android_implementation">Androidの実装</a></li>
		<li><a href="#iOS_implementation">iOSの実装</a></li>
		<li><a href="#tvOS_implementation">tvOS実装</a></li>
	</ul>
	</li>
	<li><a href="#Play_a_video_with_ads">広告で動画を再生する</a></li>
	<!-- <li><a href="#Append_query_parameters">Append query parameters</a></li> -->
</ol>
</section>

<section class="bcls-section">
<h2 id="Create_an_ad_configuration">広告設定を作成する</h2>

<p>広告設定では、動画複数広告プレイリスト（VMAP）ファイルへの URL、ビーコン、その他の設定など、SSAI 再生のさまざまな側面を定義します。広告設定を作成するには、次の手順に従います。</p>

<ol class="bcls-tasklist-restart">
	<li>
	<p>Video Cloud Studio で、[ <strong>管理</strong> ] メニューを展開し、[ <strong>サーバーサイド広告設定</strong> ] を選択します。</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Ad configuration admin" src="/assets/images/android/ssai/ad-config-admin.png" />
	<figcaption class="bcls-caption--image">広告設定管理者</figcaption>
	</figure>
	</li>
	<li>
	<p>広告設定の情報を追加して、[ <strong>保存</strong> ] を選択します。</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Ad settings" src="/assets/images/android/ssai/ad-settings.png" />
	<figcaption class="bcls-caption--image">広告の設定</figcaption>
	</figure>
	</li>
</ol>

<p>詳細については、「<a href="https://studio.support.brightcove.com/admin/configuring-server-side-ad-settings.html">サーバーサイド広告設定の構成</a>」を参照してください。</p>

<p>SSAI API を使用して広告設定を作成するには、<a href="https://ssai.support.brightcove.com/vod/guides/video-cloud-ssai-ad-config-api.html"> Video Cloud SSAI 広告設定 API </a>ドキュメントを参照してください。</p>
</section>

<section class="bcls-section">
<h2 id="Android_implementation">Androidの実装</h2>

<p>アプリ内で以下の手順に従って、広告設定を取得して動画を再生します。</p>

<ol class="bcls-tasklist-restart">
	<li>Androidスタジオで、<strong> MainActivity.java </strong>ファイルを開きます。</li>
	<li>次のインポートステートメントを追加します。
	<pre>
<code class="language-java" translate="No">import com.brightcove.ssai.SSAIComponent;
import com.brightcove.player.network.HttpRequestConfig;</code></pre>
	</li>
	<li>アカウント ID、ポリシーキー、動画 ID、広告設定 ID の定数を定義します。
	<pre class="line-numbers">
<code class="language-swift" translate="No">private String accountId = "<span class="bcls-input">your account id</span>";
private String policyKey = "<span class="bcls-input">your policy key</span>";
private String videoId = "<span class="bcls-input">your video id</span>";
private String adConfigId = "<span class="bcls-input">your ad configuration id</span>";</code></pre>

	<aside class="bcls-aside bcls-aside--tip">ポリシーキーを取得または生成する方法については、<a href="https://apis.support.brightcove.com/policy/getting-started/overview-policy-api.html">ポリシーキー</a>資料。</aside>
	</li>
	<!-- <li>In the <code translate="No">onCreate</code> method, set the query parameter value to your ad configuration id.
  	<pre class="line-numbers">
<code class="language-swift" translate="No">Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();
      parameters.put("ad_config_id", adConfigId);
      </code></pre>
  	</li> -->
	<li>Playback API からデータを取得するための非同期メソッドを提供するカタログサービスのインスタンスを作成します。SSAI コンポーネントのインスタンスを作成します。
	<pre class="line-numbers">
<code class="language-swift" translate="No">Catalog catalog = new Catalog(eventEmitter, myAccountId, myPolicyKey);
SSAIComponent plugin = new SSAIComponent(appContext, getBrightcoveVideoView());
</code></pre>
	</li>
	<li>ADConfigId を URL パラメーターとして設定します。
	<pre class="line-numbers">
<code class="language-java" translate="No">HttpRequestConfig httpRequestConfig = new HttpRequestConfig.Builder()
  .addQueryParameter("ad_config_id", myAdConfig)
  .build();</code></pre>
	</li>
	<li>カタログサービスを呼び出して、Playback API から動画と広告設定を取得します。指定した広告で動画の再生を開始します。
	<pre class="line-numbers">
<code class="language-swift" translate="No">catalog.findVideoByID(myVideoId, httpRequestConfig, new VideoListener() {
    @Override
    public void onVideo(Video video) {

    // Process the Video
    plugin.processVideo(video);
  }
});</code></pre>
	</li>
</ol>

<h3>キャプション</h3>
<aside class="bcls-aside bcls-aside--information">Android用ネイティブSDKは、SSAIでマニフェスト内のキャプションのみをサポートします。サイドカー（またはリモート）のキャプションは、コンテンツや広告休憩と同期しない場合があります。</aside>

<h3>イベント</h3>
<p>サーバー側の広告挿入に関連するイベントの詳細については、以下を参照してください。</p>
<ul>
	<li><a href="/android/reference/javadoc/com/brightcove/ssai/event/SSAIEventType.html">SSAIイベントタイプ</a></li>
</ul>

<h3>広告なしでシークする</h3>
<p>ユーザーが動画を検索している間に広告の再生を無効にする場合は、<a href="/android/resources/code-snippets-using-native-sdk-android.html#Seek_without_ads">広告コードなしの Seek </a>を参照してください。</p>

<h3>コードサンプル</h3>
<p>完全なコードサンプルは次のとおりです。</p>
<ul>
	<li><a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicSsaiSampleApp">Android 用ネイティブ SDK を使用した基本的な SSAI プレーヤー</a></li>
</ul>

<!-- <h3>Related topics</h3>
<p>For more details, see the following:</p>
<ul>
	<li><a href="/android/advertising/ssai-plugin-native-sdk-android.html">The SSAI Plugin for the Native SDK for Android</a></li>
	<li><a href="/android/advertising/ssai-plugin-native-sdk-android.html#Migrating_from_the_OnceUx_Plugin">Migrating from the OnceUX plugin</a></li>
</ul> -->
</section>

<section class="bcls-section">
<h2 id="iOS_implementation">iOSの実装</h2>

<p>アプリ内で以下の手順に従って、広告設定を取得して動画を再生します。</p>

<ol class="bcls-tasklist-restart">
	<li>Xcodeで、<strong>あなたのViewController.mファイルを開きます</strong>。</li>
	<li>iOS用のSSAIプラグインをインポートします。
	<pre>
<code class="language-swift" translate="No">import BrightcoveSSAI</code></pre>
	</li>
	<li>アカウント ID、ポリシーキー、動画 ID、広告設定 ID の定数を定義します。
	<pre class="line-numbers">
<code class="language-swift" translate="No">struct Constants {
  static let AccountID = "<span class="bcls-input">your account id</span>"
  static let PlaybackServicePolicyKey = "<span class="bcls-input">your policy key</span>"
  static let VideoId = "<span class="bcls-input">your video id</span>"
  static let AdConfigId = "<span class="bcls-input">your ad configuration id</span>"
}</code></pre>

	<aside class="bcls-aside bcls-aside--tip">ポリシーキーを取得または生成する方法については、<a href="https://apis.support.brightcove.com/policy/getting-started/overview-policy-api.html">ポリシーキー</a>資料。</aside>
	</li>
	<!-- <li>
      Define the view along with the companion view for ads.
      <pre class="line-numbers"><code class="language-swift" translate="No">class ViewController: UIViewController {
    @IBOutlet weak var videoContainerView: UIView!
    @IBOutlet weak var companionSlotContainerView: UIView!</code></pre>
    </li> -->
	<li>クラスを定義します。<code translate="No">BCOVPlaybackService</code>このクラスは、Playback API からデータを取得するための非同期メソッドを提供します。
	<pre class="line-numbers">
<code class="language-swift" translate="No">private lazy var playbackService: BCOVPlaybackService = {
  let factory = BCOVPlaybackServiceRequestFactory(accountId: Constants.AccountID, policyKey: Constants.PlaybackServicePolicyKey, baseURLStr: "https://edge.api.brightcove.com/playback/v1")
  return BCOVPlaybackService(requestFactory: factory)
}()</code></pre>
	</li>
	<li>クエリパラメータの値を広告設定 ID に設定します。
	<pre>
<code class="language-swift" translate="No">let queryParameters = [kBCOVPlaybackServiceParamaterKeyAdConfigId: Constants.AdConfigId]</code></pre>
	</li>
	<li>
	<p><code translate="No">playbackService</code>を呼び出して、Playback API から動画と広告設定を取得します。指定した広告で動画の再生を開始します。</p>

	<pre class="line-numbers">
<code class="language-swift" translate="No">playbackService.findVideo(withVideoID: Constants.VideoId, parameters: queryParameters) { [weak self] (video: BCOVVideo?, jsonResponse: [AnyHashable: Any]?, error: Error?) -&gt; Void in

  guard let _video = video else {
    print("ViewController Debug - Error retrieving video: \(error?.localizedDescription ?? "unknown error")")
    return
  }

  self?.playbackController?.setVideos([_video] as NSFastEnumeration)
}</code></pre>
	</li>
</ol>

<h3>イベント</h3>
<p>サーバー側の広告挿入に関連するイベントの詳細については、以下を参照してください。</p>
<ul>
	<li><a href="https://github.com/brightcove/brightcove-player-sdk-ios-ssai/blob/master/ios/dynamic/BrightcoveSSAI.framework/Headers/BCOVSSAIConstants.h">SSAIイベント</a></li>
	<li><a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVAdvertising.h">広告イベント</a></li>
</ul>

<h3>広告なしでシークする</h3>
<p>ユーザーが動画を検索している間に広告の再生を無効にする場合は、SDK リファレンスの「<a href="https://github.com/brightcove/brightcove-player-sdk-ios-ssai#seek-without-ads">広告なし検索</a>」セクションを参照してください。</p>

<h3>コードサンプル</h3>
<p>完全なコードサンプルは次のとおりです。</p>
<ul>
		<li><a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/SSAI/BasicSSAIPlayer">iOS 用のネイティブ SDK を使用した基本的な SSAI プレーヤー (Objective-C および Swift) </a></li>
</ul>

<h3>関連トピック</h3>
<p>詳細については、以下を参照してください。</p>
<ul>
	<li><a href="https://github.com/brightcove/brightcove-player-sdk-ios-ssai">iOS 用ネイティブ SDK 用の SSAI プラグイン</a></li>
	<!-- <li><a href="https://github.com/brightcove/brightcove-player-sdk-ios-ssai#migrating-onceux-to-ssai">Migrating from the OnceUX plugin</a></li> -->
</ul>
</section>

<section class="bcls-section">
<h2 id="tvOS_implementation">tvOS実装</h2>

<p>tvOS 用のネイティブ SDK で SSAI を実装するコードは、上記の<a href="#iOS_implementation"> iOS 実装に似ています</a>。</p>

<h3>イベント</h3>
<p>サーバー側の広告挿入に関連するイベントの詳細については、以下を参照してください。</p>

<ul>
	<li><a href="https://github.com/brightcove/brightcove-player-sdk-ios-ssai/blob/master/ios/dynamic/BrightcoveSSAI.framework/Headers/BCOVSSAIConstants.h">SSAIイベント</a></li>
	<li><a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVAdvertising.h">広告イベント</a></li>
</ul>

<h3>コードサンプル</h3>
<p>完全なコードサンプルは次のとおりです。</p>
<ul>
		<li><a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/SSAI/BasicSSAItvOSPlayer">tvOS 用のネイティブ SDK を使用する基本的な SSAIプレーヤー（Objective-CおよびSwift）</a></li>
</ul>
</section>

<!-- <section class="bcls-section">
<h2 id="Additional_notes">Additional notes</h2>

<p>There are a few technical notes to be aware of when using SSAI with the Native SDKs.</p>

<h3>Brightcove Native SDK for iOS/tvOS</h3>

<ul>
	<li><strong>Post-rolls:</strong> The OnceUX plugin translates the <code translate="No">timeOffset</code> value of <code translate="No">end</code> on the final ad break (post-roll) to a <code translate="No">CMTime</code> value of <code translate="No">+INFINITY</code>, for speed and efficiency. This translation is done AFTER the VMAP document is received (which occurs after the Playback API response is received) and BEFORE playback begins.</li>
</ul>
</section> -->
</article>