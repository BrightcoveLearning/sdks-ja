---
title: 'Android：メディアコンテンツの操作' 
description: このトピックでは、Native SDK forAndroidを使用して動画を取得して再生する方法を学習します。
parent: Basics 
grandparent: Androidの開発
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概要</h2>

<p>Video Cloud のお客様は、Video Cloud Studio からメディアデータとメタデータにアクセスできます。Brightcoveプレーヤーのお客様は、メディアコンテンツの URL を指定します。</p>
</section>

<section class="bcls-section">
<h2 id="Video_Cloud_customers">ビデオクラウドのお客様</h2>

<p>Video Cloud のお客様は、Video Cloud Studio に保存されているメディアデータにアクセスできます。詳細については、<a href="https://github.com/BrightcoveOS/android-player-samples"> Android 用 Player SDK コードサンプルを参照してください</a>。</p>

<h3>メディアデータを取得しています</h3>

<p>再生 API を使用して、Video Cloud ライブラリからビデオとプレイリストデータを取得できます。API の詳細については、「<a href="https://apis.support.brightcove.com/playback/getting-started/overview-playback-api.html">再生 API の概要</a>」ドキュメントを参照してください。</p>

<ol class="bcls-tasklist">
	<li>
	<p><a href="/android/reference/javadoc/com/brightcove/player/edge/Catalog.html">com.brightcove.Player.edge.calog </a>クラスのメソッドを使用して、Brightcoveの再生 API から動画と再生リストを取得します。あなたの要求は、<code translate="No">ID</code>ビデオ/プレイリストを提供することができます<code translate="No">ReferenceID</code> .このサービスは、URL 要求を行い、返されたデータを解析します。</p>

	<aside class="bcls-aside bcls-aside--information">特殊文字を含める場合<code translate="No">ReferenceID</code>、カタログリクエストを行う前にURIエンコードする必要があります。</aside>
	</li>
	<li>
	<p>このリクエストには、ポリシーキーが必要です。ポリシーキーに慣れていない場合は、「<a href="https://apis.support.brightcove.com/policy/getting-started/overview-policy-api.html">ポリシー API の概要</a>」ドキュメントを参照してください。</p>

	<aside class="bcls-aside bcls-aside--information">ネイティブSDKはオリジンヘッダーを送信しないため、ドメイン制限のあるポリシーキーを使用することはできません。これを試してみると、<code translate="No">403 Forbidden</code> VideoCloudライブラリからコンテンツをフェッチしようとしたときの応答。</aside>

	<p><code translate="No">com.brightcove.player.edge.Catalog</code>クラスを使用してビデオを取得する方法の例は次のとおりです。</p>

	<pre class="line-numbers">
<code class="language-java" translate="No">package com.brightcove.player.samples.exoplayer.basic;
import android.os.Bundle;
import android.util.Log;
import com.brightcove.player.edge.Catalog;
import com.brightcove.player.edge.VideoListener;
import com.brightcove.player.event.EventEmitter;
import com.brightcove.player.model.Video;
import com.brightcove.player.view.BrightcoveExoPlayerVideoView;
import com.brightcove.player.view.BrightcovePlayer;
/**
* This app illustrates how to use the ExoPlayer with the Brightcove
* Native Player SDK for Android.
*/
public class MainActivity extends BrightcovePlayer {
	private final String TAG = this.getClass().getSimpleName();
	@Override

	protected void onCreate(Bundle savedInstanceState) {
		setContentView(R.layout.activity_main);
		brightcoveVideoView = (BrightcoveExoPlayerVideoView) findViewById(R.id.brightcove_video_view);
		super.onCreate(savedInstanceState);

		// Get the event emitter from the SDK and create a catalog request to fetch a video from the
		// Brightcove Edge service, given a video id, an account id and a policy key.
		EventEmitter eventEmitter = brightcoveVideoView.getEventEmitter();
		Catalog catalog = new Catalog(eventEmitter, getString(R.string.account), getString(R.string.policy));

		catalog.findVideoByID(getString(R.string.videoId), new VideoListener() {
		  // Add the video found to the queue with add().
		  // Start playback of the video with start().
		  @Override
		  public void onVideo(Video video) {
		    Log.v(TAG, "onVideo: video = " + video);
		    brightcoveVideoView.add(video);
		    brightcoveVideoView.start();
		  }
		});
	}
}</code></pre>
	</li>
</ol>

<ol class="bcls-tasklist">
	<li>以下に示すように、<a href="/android/reference/javadoc/com/brightcove/player/model/Video.html">ビデオオブジェクトは</a>、メディア情報を取得するためのメソッドを提供します。

	<pre class="line-numbers">
<code class="language-java" translate="No">catalog.findVideoByID(getString(R.string.videoId), new VideoListener() {
  // Add the video found to the queue with add().
  // Start playback of the video with start().
  @
  Override
  public void onVideo(Video video) {
<span class="bcls-highlight">    Log.v(TAG, "onVideo: video = " + video);
    Log.v(TAG, "onVideo: videoID = " + video.getId());
    Log.v(TAG, "onVideo: videoName = " + video.getName());
    Log.v(TAG, "onVideo: videoDescription = " + video.getDescription());
    Log.v(TAG, "onVideo: videoImage = " + video.getStillImageUri());
    Log.v(TAG, "onVideo: sourceCollections = " + video.getSourceCollections());
    SourceCollection dashCollection = video.getSourceCollections().get(DeliveryType.DASH);
    if (dashCollection != null) {
      Set &lt; Source &gt; sources = dashCollection.getSources();
      for (Source source: sources) {
        if (!TextUtils.isEmpty(source.getUrl())) {
          Log.v(TAG, "onVideo: DASH source = " + source.getUrl());
        }
      }
    }</span>

    brightcoveVideoView.add(video);
    brightcoveVideoView.start();
  }
});</code></pre>

	<p><code translate="No">Log()</code>上記のメソッドは、次のメディア情報を返します。</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Video object" src="/assets/images/android/basics/video-object.png" />
	<figcaption class="bcls-caption--image">Videoオブジェクト</figcaption>
	</figure>
	</li>
  <li>
    <p>
      オブジェクトのカスタムフィールドが存在する場合は、<code translate="No">Video</code>そのオブジェクトに存在することを確認することができます。<code translate="No">onVideo</code>次のコードをコールバックメソッドに追加して、<code translate="No">customField</code>マップをループします。
    </p>
    <pre class="line-numbers">
<code class="language-java" translate="No">catalog.findVideoByID(getString(R.string.videoId), new VideoListener() {
   @
   Override
   public void onVideo(Video video) {
     <span class="bcls-highlight"> Map&lt;String, String&gt; customFieldMap = (HashMap&lt;String, String&gt;) video.getProperties().get(Video.Fields.CUSTOM_FIELDS);
     if (customFieldMap != null &amp;&amp; customFieldMap.size() &gt; 0) {
       for (Map.Entry&lt;String, String&gt; entry : customFieldMap.entrySet()) {
         Log.v(TAG, &quot;onVideo: Custom fields: Key: &quot; + entry.getKey() + &quot; Value: &quot; + entry.getValue());
       }
     }</span>
     brightcoveVideoView.add(video);
     brightcoveVideoView.start();
  }
});</code></pre>
<p>
  上記のコードからわかるログ出力の例を次に示します。
</p>
<pre class="line-numbers">
<code class="language-java" translate="No">MainActivity: onVideo: Custom fields: Key: genre Value: Action
MainActivity: onVideo: Custom fields: Key: customlist Value: customListValue1</code></pre>
<p>
  カスタムフィールドは、<code translate="No">Strings</code>またはとして表すことができることに注意してください<code translate="No">Lists</code>。<code translate="No">List</code>カスタムフィールドには型を指定できますが、<code translate="No">String</code>フィールドの値を設定するために 1 つの値が選択される値のリストです。
</p>
  </li>
</ol>

<h3>ジオフィルターされた動画</h3>

<p>Android 用 Brightcove Player SDK は、ジオフィルタリングされた動画をサポートしています。</p>

<aside class="bcls-aside bcls-aside--warning">注意:
<ul>
	<li>ジオフィルタリングされた動画で作業する場合は、再生 API を使用する必要があります。</li>
	<li>ビデオが Video Cloud でジオフィルタリングされている場合にのみ、再生サービスがエラーを返します。動画が CDN レベルでジオフィルター処理されている場合、エラーは null になります。</li>
</ul>
</aside>

<p>動画に地理フィルタリングを追加して、視聴できる（またはできない国）を制御するには、次の 2 つの方法があります。</p>

<ul>
	<li><a href="https://apis.support.brightcove.com/cms/getting-started/overview-cms-api.html">Brightcoveの CMS API </a></li>
	<li><a href="https://studio.support.brightcove.com/media/configuring-video-availability.html#geofilter">ビデオクラウドスタジオのメディアモジュール</a></li>
</ul>

<p>Android アプリで、<a href="/android/reference/javadoc/com/brightcove/player/edge/Catalog.html">Brightcoveのエッジカタログオブジェクト</a>（Playback API）を使用して動画を取得すると、その動画に対してジオフィルターが適用されている国で、次のメッセージが表示されます。</p>

<pre class="line-numbers">
<code class="language-java" translate="No">error { message: Access to this resource is forbidden by access policy.
client_geo: us
error_subcode: CLIENT_GEO
error_code: ACCESS_DENIED }</code></pre>
</section>

<section class="bcls-section">
<h2 id="Brightcove_Player_customers">Brightcoveプレーヤーのお客様</h2>

<p>Brightcove Player の顧客は、動画アセットの URL を指定します。</p>

<aside class="bcls-aside bcls-aside--information">Android SDK Nougat（7.x）の場合、AndroidのServer Name Indication（SNI）拡張機能は<code translate="No">toASCII()</code> TLS接続のホスト名の文字に制限を適用する方法。US_ASCII 非準拠のホスト名 (例:test_example.com というサブドメインにアンダースコアが含まれているなど) を持つソースをロードしようとすると、ストリームを取得しようとすると例外が発生します。<br />
<br />
したがって、HTTPSを介してソースファイルをロードする場合、ストリームのホスト名はUS_ASCIIに準拠している必要があります。</aside>

<p>次に、ビデオビューをビデオに追加して再生を開始する例を示します。</p>

<pre class="line-numbers">
<code class="language-java" translate="No">import com.brightcove.player.model.DeliveryType;
import com.brightcove.player.model.Video;
import com.brightcove.player.view.BrightcoveExoPlayerVideoView;
import com.brightcove.player.view.BrightcovePlayer;
import com.brightcove.player.analytics.Analytics;
@Override
protected void onCreate(Bundle savedInstanceState) {
	super.onCreate(savedInstanceState);
	setContentView(R.layout.activity_main);
	BrightcoveVideoView brightcoveVideoView = (BrightcoveVideoView) findViewById(R.id.brightcove_video_view);

	Analytics analytics = brightcoveVideoView.getAnalytics();
	analytics.setAccount("123456789");

	MediaController controller = new MediaController(this);
	brightcoveVideoView.setMediaController(controller);
	brightcoveVideoView.add(Video.createVideo("http://solutions.brightcove.com/bcls/assets/videos/Bird_Titmouse.mp4", DeliveryType.MP4));
	brightcoveVideoView.start();
}</code></pre>
</section>
&nbsp;

<p>次に、SDKアーキテクチャ内でイベントがどのように機能するかを見てみましょう。</p>

<div style="text-align:center"><button class="bcls-button" type="button" title="Previous button" onclick="location.href='/android/basics/android-brightcove-registration.html';">&lt;前へ</button><button class="bcls-button" type="button" title="Next button" onclick="location.href='/android/basics/understanding-events-native-sdk-android.html';">次へ &gt;</button></div>
</article>
<!-- Learning path right navigation -->
<link rel="stylesheet" href="https://support.brightcove.com/site-assets/css/site/learning-paths.css" />
<script>
    var Learning_path = [ { node: '18250', title: 'Native SDK Architecture' }、{ node: '18252', title: 'Understand the Activity Class' }、{ node: '18248', title: 'Choose a Video View' }、{ node: '18247', title: 'Register Your App' }、{ node: '18251', title: 'Use Media Content' }、{ node: '18249', title: 'Understand Events' }、{ node: '18238', title: 'Step-by-Step: Simple Video App' } ]
  </script><script src="https://support.brightcove.com/site-assets/js/site/learning-paths.js"></script>