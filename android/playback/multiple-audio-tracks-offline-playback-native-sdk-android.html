---
title: 'Android用ネイティブSDKを使用したオフライン再生用の複数のオーディオトラック' 
description: このトピックでは、Brightcove Native Player SDK for Androidを使用してオフライン再生を操作するときに、複数のオーディオトラックとテキストトラックを返す方法を学習します。
parent: Playback 
grandparent: Androidの開発
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Manage_multiple_tracks">複数のトラックを管理する</h2>

<p>デフォルトでは、キャプションファイルはなく、オーディオトラックは 1 つのみダウンロードされます。動画に関連付けられた追加のアセットをダウンロードするには、次の手順に従います。</p>

<ol class="bcls-tasklist">
	<li>
	<p>ビデオクラウドの<a href="/android/reference/javadoc/com/brightcove/player/edge/OfflineCatalog.html"> OfflineCatalog </a>クライアントへの参照を取得します。</p>

	<pre>
<code class="language-java" translate="No">private OfflineCatalog catalog;
...
catalog = new OfflineCatalog(this, eventEmitter, ACCOUNT_ID, POLICY_KEY);
...</code></pre>
	</li>
	<li>
	<p><a href="/android/reference/javadoc/com/brightcove/player/edge/AbstractOfflineCatalog.html#getMediaFormatTracksAvailable-com.brightcove.player.model.Video-com.brightcove.player.offline.MediaDownloadable.MediaFormatListener-">GetMediaFormattrackSavailable </a>メソッドを呼び出し、情報を取得する<a href="/android/reference/javadoc/com/brightcove/player/model/Video.html"> Video </a>オブジェクトを渡し、返されたデータをリッスンする<a href="/android/reference/javadoc/com/brightcove/player/offline/MediaDownloadable.MediaFormatListener.html"> MediaFormatListener </a>メソッドを呼び出します。</p>

	<pre>
<code class="language-java" translate="No">OfflineCatalog.getMediaFormatTracksAvailable(
  @NonNull final Video video,
  @NonNull final MediaDownloadable.MediaFormatListener mediaFormatListener)</code></pre>
	</li>
	<li>
	<p>は、<code translate="No">MediaFormatListener</code>次のメソッドを呼び出します。</p>

	<pre>
<code class="language-java" translate="No">void onResult(MediaDownloadable mediaDownloadable, Bundle mediaFormatBundle);</code></pre>

	<p><a href="/android/reference/javadoc/com/brightcove/player/offline/MediaDownloadable.html">MediaDownloadable </a>オブジェクトには、ビデオレンディション、オーディオ言語、キャプションなどの情報が含まれます。<code translate="No">mediaDownloadable</code>オブジェクトはキャッシュされ、<a href="/android/reference/javadoc/com/brightcove/player/edge/AbstractOfflineCatalog.html#downloadVideo-com.brightcove.player.model.Video-"> OfflineCatalog.DownloadVideo (ビデオ) </a>を呼び出すときに使用されます。</p>

	<p><a href="/android/reference/javadoc/com/brightcove/player/offline/MediaDownloadable.MediaFormatListener.html">バンドルオブジェクトには</a>、利用可能な Media Format トラックに関する情報が含まれ、次のプロパティがあります。</p>

	<ul>
		<li><a href="/android/reference/javadoc/com/brightcove/player/offline/MediaDownloadable.html#VIDEO_RENDITIONS">MediaDownloadable.video_Renditions </a> - <code translate="No">MediaFormat</code>オブジェクトの配列リストが含まれています</li>
		<li><a href="/android/reference/javadoc/com/brightcove/player/offline/MediaDownloadable.html#AUDIO_LANGUAGES">MediaDownloadable.Audio_Languages </a> - <code translate="No">MediaFormat</code>オブジェクトの配列リストが含まれます。</li>
		<li><a href="/android/reference/javadoc/com/brightcove/player/offline/MediaDownloadable.html#AUDIO_LANGUAGE_ROLES">MediaDownloadable.Audio_Language_Roles </a> -文字列の配列リストが含まれます。このリストには、に関する追加情報が表示されます<code translate="No">MediaDownloadable.AUDIO_LANGUAGES</code>。インデックスはオーディオ言語リストと一致します。オーディオロールの例はメインと代替になります。</li>
		<li><a href="/android/reference/javadoc/com/brightcove/player/offline/MediaDownloadable.html#CAPTIONS">MediaDownloadable.Captions </a> - <code translate="No">MediaFormat</code>オブジェクトの配列リストが含まれています</li>
	</ul>
	</li>
	<li>
	<p>バンドルからデータのリストを取得します。異なるリストを取得するための例を次に示します。</p>

	<pre>
<code class="language-java" translate="No">ArrayList&lt;MediaFormat&gt; video = bundle.getParcelableArrayList(MediaDownloadable.VIDEO_RENDITIONS);

ArrayList&lt;MediaFormat&gt; audio = bundle.getParcelableArrayList(MediaDownloadable.AUDIO_LANGUAGES);

ArrayList&lt;String&gt; roles = bundle.getStringArrayList(MediaDownloadable.AUDIO_LANGUAGE_ROLES);

ArrayList&lt;MediaFormat&gt; captions = bundle.getParcelableArrayList(MediaDownloadable.CAPTIONS);</code></pre>
	</li>
	<li>
	<p>新しい<code translate="No">Bundle</code>（<code translate="No">filteredBundle</code>）を作成して、ダウンロードに含めるオーディオトラックとクローズドキャプションを選択します。</p>

	<pre>
<code class="language-java" translate="No">Bundle filteredBundle = new Bundle();</code></pre>

	<aside class="bcls-aside bcls-aside--information">以前に作成したバンドルを再利用する場合は、すべてのオーディオトラックとクローズドキャプションをダウンロードできます。</aside>
	</li>
	<li>
	<p>以前に作成したリストから目的のトラックをフィルタリングし、新しいトラックに追加します<code translate="No">filteredBundle</code>。</p>

	<pre>
<code class="language-java" translate="No">ArrayList&lt;MediaFormat&gt; captions = bundle.getParcelableArrayList(MediaDownloadable.CAPTIONS);
if (captions != null &amp;&amp; captions.size() &gt; 0) {
   ArrayList&lt;MediaFormat&gt; newCaptions = new ArrayList&lt;&gt;();
   newCaptions.add(captions.get(0));

filteredBundle.putParcelableArrayList(MediaDownloadable.CAPTIONS, newCaptions);
}</code></pre>
	</li>
	<li>
	<p>をセットする<code translate="No">filteredBundle</code>に<code translate="No">MediaDownloadable</code>オブジェクト。</p>

	<pre>
<code class="language-java" translate="No">mediaDownloadable.setConfigurationBundle(filteredBundle);</code></pre>
	</li>
	<li>
	<p>ビデオをダウンロードしてください。</p>

	<pre>
<code class="language-java" translate="No">offlineCatalog.downloadVideo(video);</code></pre>

	<p>内部的には、<code translate="No">OfflineCatalog</code>キャッシュされたものを使用します<code translate="No">MediaDownloadable</code>によって提供される<code translate="No">MediaDownloadable.MediaFormatListener</code>折り返し電話。</p>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Code_sample">コードサンプル</h2>

<p>追加のオーディオトラックとキャプションファイルをダウンロードする完全な例については、<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/OfflinePlaybackSampleApp/src/main/java/com/brightcove/player/samples/offlineplayback">オフライン再生サンプルアプリを参照してください</a>。</p>
</section>
</article>