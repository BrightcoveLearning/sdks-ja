---
title: 'Android用ネイティブSDKのプラグインを作成する' 
description: このトピックでは、Android用ネイティブSDKのプラグインを作成する方法を学習します。
parent: Framework 
grandparent: Androidの開発
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概要</h2>

<p>高いレベルでは、プラグインはイベントをリッスンして放出することによって、プレーヤーと統合されます。プラグインは、プレーヤーや他のプラグインからのイベントをリッスンすることができます。プラグインは、プレーヤーや他のプラグインのイベントを放出することができます。</p>

<p>このコンテンツとサンプルコードについては<a href="https://github.com/BrightcoveOS/android-plugin-guide"> https://github.com/BrightcoveOS/android-plugin-guide </a></p>
</section>

<section class="bcls-section">
<h2 id="Plugin_architecture">プラグインアーキテクチャ</h2>

<div class="BCL-concept">
<p>プラグインは、インスタンス化されたときに SDK に登録する必要があります。プラグインを登録するには、<code translate="No">REGISTER_PLUGIN</code>とのイベント<code translate="No">PLUGIN_NAME</code>プロパティ。例は次のとおりです。</p>

<pre class="line-numbers">
  <code class="language-java" translate="No">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();
  properties.put(Event.PLUGIN_NAME, "my custom plugin");
  eventEmitter.emit(EventType.REGISTER_PLUGIN, properties);</code></pre>

<p>ビデオの再生は、通常、標準のライフサイクルイベントフローを経由します。</p>

<figure class="bcls-figure"><img class="bcls-image" alt="Plugin event flow" src="/assets/images/android/framework/plugin-event-flow.png" />
<figcaption class="bcls-caption--image">プラグインイベントフロー</figcaption>
</figure>
</div>
</section>

<section class="bcls-section">
<h2 id="Event_details">イベントの詳細</h2>

<div class="BCL-concept">
<p>プラグインは、プレイヤーのデフォルトの動作を変更するために、いくつかのアクションを開始するイベントをリッスンすることができます。これらのイベントには次のものがあります。</p>

<ol>
	<li><code translate="No">WILL_CHANGE_VIDEO</code></li>
	<li><code translate="No">SET_VIDEO</code></li>
	<li><code translate="No">SET_SOURCE</code></li>
	<li><code translate="No">PLAY</code></li>
	<li><code translate="No">PAUSE</code></li>
	<li><code translate="No">SEEK_TO</code></li>
	<li><code translate="No">STOP</code></li>
</ol>

<p>デフォルトの動作を変更するには、デフォルトリスナーがイベントを受信できないようにしたり、デフォルト以外のリスナーへのイベントの伝播を停止したりします。デフォルトのリスナーがイベントを受信しないようにするには、<code translate="No">preventDefault()</code>メソッドを呼び出します。イベント伝播は、<code translate="No">stopPropagation()</code>メソッドを呼び出すことで停止できます。<code translate="No">preventDefault()</code>だけが呼び出された場合、デフォルト以外の残りのリスナーに通知されます。<code translate="No">stopPropagation()</code>だけが呼び出された場合、デフォルトのリスナーに通知されますが、デフォルト以外のリスナーの残りの部分はスキップされます。プラグインは、これらのメソッドを使用して、通常のイベントフローを一時停止し、プラグインの初期化などの追加の動作を挿入することもできます。プラグインは、元のイベントを再度放出することで、イベントフローを再開できます。</p>

<p>プラグインは、アクションの完了を通知するイベントをリッスンすることもできます。これらのイベントは、通常、分析プラグインによって使用されます。イベントには次のものがあります。</p>

<ol>
	<li><code translate="No">DID_CHANGE_LIST</code></li>
	<li><code translate="No">DID_SELECT_SOURCE</code></li>
	<li><code translate="No">DID_PAUSE</code></li>
	<li><code translate="No">DID_PLAY</code></li>
	<li><code translate="No">DID_SEEK_TO</code></li>
	<li><code translate="No">DID_SET_SOURCE</code></li>
	<li><code translate="No">DID_STOP</code></li>
	<li><code translate="No">PROGRESS</code></li>
	<li><code translate="No">COMPLETED</code></li>
</ol>
</div>
</section>

<section class="bcls-section">
<h2 id="Interrupt_playback">再生を中断する</h2>

<div class="BCL-concept">
<p>ビデオコンテンツの再生を中断したいプラグインは、<code translate="No">WILL_INTERRUPT_CONTENT</code>とを使用する必要があります<code translate="No">WILL_RESUME_CONTENT</code>。これらのイベントは、通常、広告プラグインで使用されます。プラグインは、<code translate="No">WILL_INTERRUPT_CONTENT</code>再生を中断し、現在再生中の場合は再生を停止し、ビデオビューを非表示にすることを要求するために放出する必要があります。プラグインは、<code translate="No">WILL_RESUME_CONTENT</code>ビデオビューを再び表示するように要求するために放出する必要があります。<code translate="No">WILL_RESUME_CONTENT</code>イベントには、<code translate="No">ORIGINAL_EVENT</code>ビデオビューが表示されるようにした後に放出されるプロパティを含める必要があります。NS <code translate="No">ORIGINAL_EVENT</code>する必要があります<code translate="No">PLAY</code>再生を再開するイベント、<code translate="No">CUE_POINT</code>キューポイント処理を続行するイベント、または<code translate="No">COMPLETED</code>再生を完了するためのイベント。NS <code translate="No">SKIP_CUE_POINTS</code>プロパティをに追加する必要があります<code translate="No">ORIGINAL_EVENT</code>再帰的なキューポイント処理を防ぐため。</p>
</div>
</section>

<section class="bcls-section">
<h2 id="Cue_points">キューポイント</h2>

<div class="BCL-concept">
<p><code translate="No">CUE_POINT</code>多くのプラグインはイベントをリッスンしたいでしょう。キューポイントには、、<code translate="No">BEFORE</code><code translate="No">POINT_IN_TIME</code>、の3種類があります<code translate="No">AFTER</code>。<code translate="No">BEFORE</code>キューポイントは、再生が始まる直前に放出されます。<code translate="No">POINT_IN_TIME</code>キューポイントは、再生がキューポイントの位置に達したときに放出されます。<code translate="No">AFTER</code>キューポイントは、再生が完了した直後に放出されます。プラグインは使用する必要があります<code translate="No">WILL_INTERRUPT_CONTENT</code>と<code translate="No">WILL_RESUME_CONTENT</code>キューポイントイベントを処理するときにコンテンツの再生を中断および再開するイベント。前と後のキューポイントの場合、<code translate="No">ORIGINAL_EVENT</code><code translate="No">PLAY</code>イベントにはイベントまたはイベントを含むプロパティが含まれます。<code translate="No">COMPLETED</code>イベント。キューポイントイベントには、<code translate="No">CUE_POINTS</code>キューポイントのバッチを持つプロパティ。<code translate="No">START_TIME</code>そして<code translate="No">END_TIME</code>プロパティは、キューポイントの時間範囲を定義します。</p>
</div>
</section>

<section class="bcls-section">
<h2 id="Sample_directory">サンプルディレクトリ</h2>

<div class="BCL-concept">
<p><a href="https://github.com/BrightcoveOS/android-plugin-guide/tree/master/sample">サンプルディレクトリには</a>、次の 2 つのモジュールを持つ Android Studio ベースのプロジェクトが含まれています。</p>

<ul>
	<li><strong>SamplePlugin </strong> -新しいプラグインを書くための基礎として使用することができるサンプルプラグイン、。</li>
	<li><strong>SamplePluginApplication </strong> -プラグインが Brightcove 動画アプリケーションにどのように組み込まれ、SamplePlugin または新しいプラグインをテストするために使用できるかを示します。</li>
</ul>
</div>
</section>

<section class="bcls-section">
<h2 id="Implementation_steps">実装手順</h2>

<div class="BCL-concept">
<p>プラグインを書く手順は次のとおりです。</p>

<ol>
	<li>サンプルプラグインを新しいリポジトリにコピーします。</li>
	<li>パッケージ名とクラス名を変更します。</li>
	<li><code translate="No">TAG</code>イニシャライザを更新します。</li>
	<li>編集する<code translate="No">@Emits</code>そして<code translate="No">@ListensFor</code>プラグインが発行およびリッスンするイベントを反映するアノテーション。</li>
	<li>必要に応じてコンストラクタを変更します。</li>
	<li>必要に応じて、<code translate="No">videoView</code>関連するロジックを置き換えるか削除します。</li>
	<li>必要に応じて、イベントリスナーを追加または減算して変更します<code translate="No">initializeListeners()</code>。</li>
	<li>Android Studio <strong>用の.aar </strong>ファイルとしてプラグインをコンパイルして配布します。</li>
	<!--                <li>Compile and distribute your plugin as a .jar file for Eclipse and/or an .aar file for Android Studio.</li>-->
</ol>
</div>
</section>
</article>