---
title: 'Android用ネイティブSDKのキャストプラグイン' 
description: このトピックでは、Brightcove Native SDK for AndroidのCastプラグインを使用して、Chromecastに接続されたテレビに動画をキャストする方法を学習します。
parent: Connected TV 
grandparent: Androidの開発
layout: staging
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Overview">概要</h2>

<p><a href="https://developers.google.com/cast/docs/developers">Google キャストテクノロジを使用すると</a>、モバイルデバイスからハイビジョンテレビや家庭用オーディオシステムへのストリーミング動画コンテンツを開始および制御できます。アプリから [キャスト] ボタンをタップして、大画面でコンテンツをストリーミングします。</p>

<p>キャストアプリケーションを構築するには、次のコンポーネントが必要です。</p>

<ul>
	<li>
	<p><strong>送信者アプリケーション</strong> -これはモバイルデバイス上に存在し、受信デバイスを検出し、安全な接続を確立し、コンテンツをミラーリングします。送信者アプリは、Chromecast デバイスのレシーバーアプリにコンテンツをキャストするために使用されるローカルプレーヤーです。Receiver アプリにキャストしたら、Chromecast のリモコンと考えることができます。</p>

	<p>送信者アプリは、Android 用 Brightcove ネイティブ SDK 用のキャストプラグインによって提供されます。このトピックでは、それについて学びます。</p>
	</li>
	<li>
	<p><strong>受信機アプリケーション</strong> -このアプリケーションは Chromecast デバイス上で動作します。これは、CSSとJavaScriptアセットを持つ単一ページの HTML アプリと考えることができます。</p>

	<p>テストを行うには、次の手順を実行します。</p>

	<ol class="bcls-tasklist">
		<li><a href="https://github.com/googlecast/CastReceiver">Googleのサンプルキャスト受信機から始める</a></li>
		<li><a href="https://developers.google.com/cast/docs/sample-apps#castreceiver">Google キャストアプリのドキュメントを確認する</a></li>
	</ol>

	<p>本マニュアルでは、本稼働環境で使用するために、Brightcove Receiver v2.0.0 の使用方法を説明します。</p>
	</li>
</ul>

<aside class="bcls-aside bcls-aside--information">
  <p>注意:</p>
  <ol>
    <li>Google は、実稼働環境でのデモ受信機アプリの使用をサポートしていません。</li>
    <li>Android 版 Brightcove ネイティブ SDK 用のキャストプラグインは、レシーバーアプリの機能を提供しません。</li>
  </ol>
  </aside>
</section>

<section class="bcls-section">
<h2 id="Supported_SDK_version">サポートされている SDK バージョン</h2>
<p>新しい Brightcove Receiver v2.0 でキャストプラグインを使用するには、バージョン 6.16.0 以降の Android 用 Brightcove ネイティブ SDK を使用する必要があります。</p>
</section>

<section class="bcls-section">
<h2 id="Understanding_the_Cast_plugin">キャストプラグインの理解</h2>
<p>キャストプラグインは、<a href="https://medium.com/google-exoplayer/new-cast-extension-and-demo-app-55816a50012">新しい ExoPlayer キャスト拡張機能と</a> Google Play サービスキャストフレームワークの上に構築されています。キャストプラグインの依存関係を追加した後、gradleは他の必要な依存関係と一緒にPlay Servicesキャストフレームワークの依存関係、ExoPlayerキャスト拡張依存関係を引き出します。</p>

<p>キャストプラグインは再設計され、Video Cloud と統合する際の労力を最小限に抑えることができます。Video Cloud を使用する場合、<code translate="No">BrightcoveCastMediaManager</code>クラスはビデオクラウドレスポンスから Brightcove <code translate="No">Video</code>や Brightcove などの情報を収集します。<code translate="No">Source</code>オブジェクト。<code translate="No">EventType.SET_SOURCE</code>イベントが放出されるたびに。この情報はキャッシュされ、ユーザーが [再生] を選択してビデオをキューに入れるときに使用できます。</p>
</section>

<section class="bcls-section">
<h2 id="Integrating_the_Cast_plugin">キャストプラグインの統合</h2>
<p>Android キャストプラグイン用のネイティブ SDK とアプリを統合するには、2 つの方法があります。Brightcoveキャストレシーバー v2.0 または Google キャストデモレシーバーと統合できます。</p>
<p>どちらの統合でも、この依存関係をアプリプロジェクトに追加する必要があります。</p>
<pre>
<code class="language-java" translate="No">implementation &quot;com.brightcove.player:android-cast-plugin:6.16.0&quot;</code></pre>

<h3 id="Using_the_Brightcove_Cast_Receiver_v2">Brightcoveキャストレシーバー v2.0 を使用する</h3>
<p>この統合は、Brightcove API を使用してコンテンツを配信しているBrightcoveのお客様を対象としています。</p>
<p>完全なコードサンプルについては、「<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicCastBrightcoveReceiverSampleApp"> basicCastBrightCoveReceiverSampleApp </a>」を参照してください。</p>

<h3 id="Using_the_Google_Cast_Demo_Receiver">Google キャストデモ受信機を使用する</h3>
<p>この統合は、キャスティングを初めて利用するBrightcoveのお客様を対象としています。</p>
<p>完全なコードサンプルについては、<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/BasicCastGoogleReceiverSampleApp"> BasicCastGoogleReceiverSampleApp </a>を参照してください。</p>
<aside class="bcls-aside bcls-aside--tip">NS <strong> BasicCastGoogleReceiverSampleApp</strong>サンプルアプリは、以前は<strong>BasicCastSampleApp</strong></aside>

<h4 id="Specifying_your_own_Cast_Receiver_App_Id">独自のキャストレシーバーアプリIDを指定する</h4>
<p><strong>BasicCastGoogleReceiverSampleApp </strong>は、Google デモレシーバーアプリ ID を設定します。これは、開始やテストには役立ちますが、実稼働には役立ちません。</p>
<p>Cast Receiver アプリケーションでこの値を上書きするには、サンプルアプリケーションの<strong> strings.xml </strong>ファイルに次の文字列値を定義します。</p>
<pre>
<code class="language-java" translate="No">&lt;string name=&quot;cast_receiver_app_id&quot;&gt;4F8B3483&lt;/string&gt;</code></pre>
</section>

<section class="bcls-section">
<h2 id="The_Brightcove_GoogleCastComponent">Brightcove GoogleCastComponent</h2>

<p><code translate="No">GoogleCastComponent</code>このクラスは、Brightcoveキャストプラグインのメインクラスです。これは、exoPlayer CastPlayer をインスタンス化し、そのリスナーを設定します。ビデオをロードしたり、キューに追加したりするために、いくつかの重要なメソッドを公開しています。また、<code translate="No">GoogleCastComponent</code>このクラスでは、アクティビティおよびフラグメントのライフサイクルイベントを処理する複数の Brightcove イベントリスナー、および Media Info を放出して Chromecast デバイスに動画を読み込むために使用できるその他のイベントリスナーも追加します。</p>

<p>では、Builder <code translate="No">GoogleCastComponent</code>パターンが使用されるようになりました。Android 版 v6.16.0 より前のネイティブ SDK では、コンポーネントをインスタンス化し、<code translate="No">Context</code><code translate="No">EventEmitter</code>およびを<code translate="No">GoogleCastComponent</code>コンストラクタ。次に、一連の個別のメソッド呼び出しでコンポーネントのオプションを設定します。</p>
<p>Android 用 Native SDK v6.16.0 以降では、Builder パターンを使用してのインスタンスを作成し、そのオプションを設定します。すべてを Builder メソッド呼び出しの 1 つのチェーン内で実行します。<code translate="No">GoogleCastComponent</code></p>
</section>

<section class="bcls-section">
<h2 id="CustomData">CustomData</h2>
<p>と同様に<code translate="No">GoogleCastComponent</code>、<code translate="No">CustomData</code>クラスは Builder パターンを使用してオブジェクトをインスタンス化し、そのオブジェクトにプロパティを追加します。Brightcove Receiver <code translate="No">CustomData</code>はを使用して Brightcove カタログから動画を取得できますが、リモートアセットをキャストする場合など、<code translate="No">CustomData</code>完全なオブジェクトを送信する必要はありません。また、Google Demo Receiverを使用する場合、<code translate="No">CustomData</code>の使用はサポートされていないことに注意してください。この説明では、<code translate="No">CustomData</code>Brightcoveカタログから動画データを取得するために使用される受信機への送信に重点を置きます。</p>

<h3>CustomDataって何ですか</h3>
<p><code translate="No">CustomData</code>はオブジェクトに含まれる JSON <code translate="No">MediaInfo</code>オブジェクトです。これは、Brightcoveキャストレシーバーアプリ v2.0 での使用を目的としています。</p>

<h3>Brightcoveレシーバーおよびカタログデータによる CustomData</h3>
<p>Brightcove Receiver と統合する場合、<code translate="No">CustomData</code> JSON オブジェクトは次の形式になります。</p>
<pre>
<code class="language-java" translate="No">&quot;customData&quot;: {
	&quot;accountId&quot;: &quot;1234567890&quot;,
	&quot;analyticsParams&quot;: {
		&quot;application&quot;: &quot;com.brightcove.player.test&quot;,
		&quot;user&quot;: &quot;abcde1c44b951234&quot;
	},
	&quot;catalogParams&quot;: {
		&quot;adConfigId&quot;: null,
		&quot;type&quot;: &quot;video&quot;,
		&quot;bcovAuthToken&quot;: null,
		&quot;id&quot;: &quot;2345678901&quot;,
		&quot;policyKey&quot;: &quot;BCpkPolicyKeyObject&quot;
	}
}
</code></pre>

<p><code translate="No">CustomData</code>上記のオブジェクトの例には、Brightcove Receiver から動画をキャストするために必要なすべてのデータ要素が含まれています。このデータは暗号化に関係なく同じです。つまり、DRM動画の場合、ライセンスURLに追加の構造は必要ありません。</p>
<p><code translate="No">CustomData</code>オブジェクトの例は、<strong> BrightCoveCastCoveReceiverSampleApp </strong>にもあります。</p>

<h3>Googleデモ受信機とカスタムデータ</h3>
<p>上記のように、<code translate="No">CustomData</code>は Google デモレシーバーではサポートされていません。</p>

</section>

<section class="bcls-section">
<h2 id="BrightcoveCastMediaManager">BrightCoveCastMediaManager</h2>

<p>上記のように<code translate="No">BrightcoveCastMediaManager</code>、を拡張して、そのメソッドをオーバーライドしたり、独自のメソッドを実装することができます。BrightCoveCastMediaManager クラスの拡張の例については、以下を参照してください。</p>
<ul>
  <li>BrightCoveCastMediaManager セクションを拡張する</li>
  <li>basicCastCustomRemoteVideoSampleApp</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="OptionsProvider">OptionsProvider</h2>

<p>次に、<a href="https://developers.google.com/android/reference/com/google/android/gms/cast/framework/OptionsProvider"> GoogleキャストフレームワークのOptionsProvider実装を指定する必要があります</a>。<code translate="No">OptionsProvider</code>インターフェイスは、<a href="https://developers.google.com/android/reference/com/google/android/gms/cast/framework/CastContext"> CastContextクラスを初期化するために必要ないくつかのオプションを設定するのに役立ちます</a>。ここでキャストレシーバーアプリ ID を設定します。の統合の詳細については<code translate="No">OptionsProvider</code>、Google の「<a href="https://developers.google.com/cast/docs/android_sender_integrate#initialize_the_cast_context">キャストコンテキストの初期化</a>」ドキュメントを参照してください。</p>
<p><code translate="No">DefaultOptionsProvider</code>Brightcoveのキャストプラグインにはクラスが含まれています。このクラスでは、キャストレシーバーアプリケーション ID は、<strong> strings.xml </strong>リソースファイルに設定された文字列キーを使用して設定されます。詳細およびアプリで無効にする方法については、上記の「<a href="#Using_your_own_Cast_Receiver_App_Id">独自のキャスト Receiver アプリ ID を使用する</a>」セクションを参照してください。</p>
<p><code translate="No">DefaultOptionsProvider</code><code translate="No">OptionsProvider</code>クラスを使用するか独自の実装を使用するかにかかわらず、<code translate="No">OptionsProvider</code>以下に示すように、アプリケーションの<strong> AndroidManifest.xml</strong>ファイルの実装クラス名をキーと値のペアのメタデータとして指定します。</p>
<pre>
<code class="language-java" translate="No">&lt;meta-data android:name=&quot;com.google.android.gms.cast.framework.OPTIONS_PROVIDER_CLASS_NAME&quot; android:value=&quot;com.brightcove.cast.DefaultOptionsProvider&quot; /&gt;</code></pre>
<p><code translate="No">DefaultOptionsProvider</code>クラスを使用する場合は、<code translate="No">ExpandedControllerActivity</code>で同様のメタデータ情報を設定して、キャスト通知をオン/オフするようにを設定できます。<strong>androidManifest</strong>。</p>
</section>

<section class="bcls-section">
<h2 id="Expanded_Controller_Activity">拡張されたコントローラアクティビティ</h2>

<p><a href="https://developers.google.com/android/reference/com/google/android/gms/cast/framework/media/widget/ExpandedControllerActivity">ExpandedControllerActivity </a>には Google キャストライブラリが付属しており、Chromecast デバイスにキャストされている動画を制御できます。このクラスは、カスタマイズの柔軟性を提供します。たとえば、ボタンを表示できる 5 つのスロットがあり、3 番目のスロットは設定不可の [再生] ボタン用に予約されています。残りのボタンは、他の定義済みボタンとして設定することも、独自のカスタマイズボタンとして設定することもできます。</p>

<p>Brightcoveのキャストプラグインは、サブクラスを提供します<code translate="No">DefaultExpandedControllerActivity</code>。次のボタンは次の順序で有効になっています。</p>

<ul>
	<li><strong>クローズドキャプション</strong></li>
	<li><strong>前をスキップ</strong></li>
	<li><strong>遊ぶ</strong></li>
	<li><strong>次をスキップ</strong></li>
	<li><strong>ミュート切り替え</strong></li>
</ul>

<p>さらに、Seek Bar は、標準で使用されているものと同じデフォルトの描画可能を設定します<code translate="No">BrightcoveMediaController</code>。</p>

<ul>
	<li>進行状況ドロワブル:
	<pre>
<code class="language-java" translate="No">R.drawable.default_scrubber_progress_horizontal</code></pre>
	</li>
	<li>親指ドロー可能:
	<pre>
<code class="language-java" translate="No">R.drawable.default_scrubber_thumb</code></pre>
	</li>
</ul>

<p>シークバーをカスタマイズする方法については、<a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-player-controls/SeekBarColorsSampleApp/src/main"> SeekBarColorsSampleApp </a>を参照してください。</p>

<p><code translate="No">DefaultExpandedControllerActivity</code>または独自のを設定するには<code translate="No">ExpandedControllerActivity</code>、<strong> AndroidManifest.xml </strong>ファイルに次のメタデータを設定します。</p>
<pre class="line-numbers">
<code class="language-java" translate="No">&lt;meta-data  android:name="com.brightcove.cast.DefaultOptionsProvider.EXPANDED_CONTROLLER_ACTIVITY_CLASS_NAME"
android:value="com.brightcove.cast.DefaultExpandedControllerActivity" /&gt;</code></pre>
</section>

<section class="bcls-section">
<h2 id="Cast_Notification">キャスト通知</h2>

<p>キャスト通知が有効な場合、ホームキーを押した後など、ビデオをキャストしてアプリをバックグラウンドに配置すると、通知が表示されます。</p>
&lt;PT キャスト通知を有効にするには、<strong> AndroidManifest.xml </strong>ファイルに次のメタデータを設定し、通知がクリックされたときに起動するアクティビティの名前を指定します。</p>
<pre class="line-numbers">
<code class="language-java" translate="No">&lt;meta-data android:name="com.brightcove.cast.DefaultOptionsProvider.NOTIFICATION_TARGET_ACTIVITY_CLASS_NAME"
android:value="com.brightcove.cast.BrightcoveControllerActivity" /&gt;</code></pre>

<p>com.brightCove.cast.DefaultoptionsProvider.Notification_target_activity_Class_name を指定しない場合、または値に無効なアクティビティ名が含まれている場合、キャスト通知はオフになります。</p>

<aside class="bcls-aside bcls-aside--information">を削除しながら<code translate="No">meta-data</code>からのタグ<strong>AndroidManifest.xml</strong>ファイルは送信者アプリからの通知を無効にしますが、デバイスがWi-Fiネットワークにキャストしていることを示す通知を送信者デバイスで表示することは引き続き可能です。これは送信者アプリからの通知ではなく、アプリの構成に関係なく、送信者デバイスからの通知です。</aside>
</section>

<section class="bcls-section">
<h2 id="The_Cast_Button">キャストボタン</h2>

<p>キャストボタンを使用すると、デバイスと同じネットワーク内の Chromecast デバイスを選択し、接続してセッションを作成できます。アプリケーションに [キャスト] ボタンを追加するには、Google <a href="https://developers.google.com/cast/docs/android_sender_integrate#add_a_cast_button">の統合キャストに従ってください。キャストボタンドキュメントを追加します</a>。</p>
<p>Brightcoveのキャストプラグインは、キャストボタンを簡単に設定するためのユーティリティメソッドを提供します。これは、[Activity/Fragment] メニューに [キャスト] ボタンを追加するだけの場合に便利です。詳細については、次のコードを参照してください。</p>
	<pre class="line-numbers">
<code class="language-java" translate="No">//Activity
@Override
public boolean onCreateOptionsMenu(Menu menu) {
   super.onCreateOptionsMenu(menu);
   GoogleCastComponent.setUpMediaRouteButton(MainActivity.this, menu);
   return true;
}</code></pre>
</section>

<section class="bcls-section">
<h2 id="The_Mini_Controller">ミニコントローラー</h2>

<p>ミニコントローラは、アクティビティに添付されるフラグメントで、通常はレイアウトの下部にあります。ミニコントローラーを使用すると、ビデオを再生および一時停止でき、Chromecast デバイスでビデオが再生されるタイミングを示します。ミニコントローラをクリックすると、拡張コントローラが起動します。</p>
<p>ミニコントローラを有効にするには、アクティビティのレイアウトに次のコードを追加します。</p>
	<pre class="line-numbers">
<code class="language-java" translate="No">&lt;fragment
   android:id="@+id/castMiniController"
   android:layout_width="match_parent"
   android:layout_height="wrap_content"
   android:layout_alignParentBottom="true"
   android:visibility="gone"
   class="com.google.android.gms.cast.framework.media.widget.MiniControllerFragment" /&gt;</code></pre>

<p>ミニコントローラのベストプラクティスを学ぶには、<a href="https://developers.google.com/cast/docs/design_checklist/sender#sender-mini-controller">デザインチェックリストを参照してください。送信者ミニコントローラ文書</a>。実装の詳細については、<a href="https://developers.google.com/cast/docs/android_sender_integrate#add_mini_controller">統合キャストを参照してください。ミニコントローラドキュメントを追加します</a>。</p>
</section>

<section class="bcls-section">
<h2 id="Advanced_Topics">高度なトピック</h2>

<h3 id="Listening_for_Cast_session">キャストセッションをリッスン中</h3>

<p>Cast接続の開始時または終了時にアプリを反応させたい場合は、<code translate="No">GoogleCastEventType.CAST_SESSION_STARTED</code>または<code translate="No">GoogleCastEventType.CAST_SESSION_ENDED</code>ここに示すイベントリスナー：</p>

<pre class="line-numbers">
<code class="language-java" translate="No">eventEmitter.on(GoogleCastEventType.CAST_SESSION_STARTED, new EventListener() {
   @Override
   public void processEvent(Event event) {
       // Session Started
   }
});
eventEmitter.on(GoogleCastEventType.CAST_SESSION_ENDED, new EventListener() {
   @Override
   public void processEvent(Event event) {
       // Session Ended
   }
});</code></pre>

<p>または、<code translate="No">GoogleCastComponent.isSessionAvailable()</code>を呼び出して、利用可能なセッションをチェックすることもできます。</p>

<h3 id="Casting_a_Video">ビデオのキャスティング</h3>

<p>接続に成功した後、ビデオを Chromecast にキャストするには、EventeMitter を使用してメディア情報情報を放出するか、<code translate="No">GoogleCastComponent</code>メソッドを直接使用することができます。</p>

<p>メディア情報を放出する場合は、次のイベントを使用できます。</p>

<ul>
	<li><code translate="No">GoogleCastEventType.LOAD_MEDIA_INFO</code></li>
	<li><code translate="No">GoogleCastEventType.LOAD_MEDIA_QUEUE_ITEM</code></li>
	<li><code translate="No">GoogleCastEventType.ADD_MEDIA_INFO</code></li>
	<li><code translate="No">GoogleCastEventType.ADD_MEDIA_QUEUE_ITEM</code></li>
</ul>

<p>次の表に、各イベントで期待されるプロパティを示します。</p>

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th rowspan="2">イベント名</th>
			<th colspan="2">プロパティ</th>
		</tr>
		<tr>
			<th>キー</th>
			<th>値クラスタイプ</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td><code translate="No">LOAD_MEDIA_INFO</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_INFO</code><br />
			<code translate="No">GoogleCastComponent.CAST_MEDIA_PLAY_POSITION</code></td>
			<td><code translate="No">MediaInfo</code>整数</td>
		</tr>
		<tr>
			<td><code translate="No">LOAD_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">MediaQueueItem</code></td>
		</tr>
		<tr>
			<td><code translate="No">ADD_MEDIA_INFO</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_INFO</code><br />
			<code translate="No">GoogleCastComponent.CAST_MEDIA_PLAY_POSITION</code></td>
			<td><code translate="No">MediaInfo</code>整数</td>
		</tr>
		<tr>
			<td><code translate="No">ADD_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">GoogleCastComponent.CAST_MEDIA_QUEUE_ITEM</code></td>
			<td><code translate="No">MediaQueueItem</code></td>
		</tr>
	</tbody>
</table>
<br/>
<p>または、<code translate="No">GoogleCastComponent</code>次の方法を使用できます。</p>

<ul>
	<li>
	<pre>
<code class="language-java" translate="No">public void loadMediaInfo(MediaInfo mediaInfo, long positionMs)</code></pre>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">public void loadMediaInfo(MediaInfo mediaInfo)</code></pre>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">public PendingResult&lt;RemoteMediaClient.MediaChannelResult&gt; loadItem(MediaQueueItem mediaQueue, int playheadPosition)</code></pre>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">public PendingResult&lt;RemoteMediaClient.MediaChannelResult&gt; addItems(MediaQueueItem... mediaQueue )</code></pre>
	</li>
</ul>

<h3 id="Changing_the_default_MediaInfo_data">デフォルトの MediaInfo データの変更</h3>

<p>デフォルトでは、キャストプラグインは、によって放出される現在の Video オブジェクトと Source オブジェクトに関する情報を収集します<code translate="No">EventType.SET_SOURCE event</code>。App Receiver が認識するカスタム JSON オブジェクトをユーザーに追加するなど、追加情報を変更または追加する場合は、<code translate="No">MediaInfo</code><code translate="No">loadMediaInfo()</code><code translate="No">addMediaInfo()</code>とからのメソッド<code translate="No">BrightcoveCastMediaManager</code>。次に、あなたの<code translate="No">BrightcoveCastMediaManager</code>サブクラスはコンストラクターパラメーターとしてに渡されます<code translate="No">GoogleCastComponent</code>クラス。</p>

<p>これらのメソッドの内部では、<code translate="No">MediaInfo</code>オブジェクトを作成し、前述のように、適切なイベントを放出することができます。必ず確認してください<code translate="No">com.brightcove.cast.util.CastMediaUtil</code>、を作成するためのいくつかのユーティリティメソッドを提供するため<code translate="No">MediaInfo</code> VideoオブジェクトとSourceオブジェクトから。</p>

<h3 id="Configuring_the_Cast_MediaController">キャストメディアControllerの設定</h3>

<p>キャストセッションの開始時に Brightcove 動画ビューに表示されるコントローラーのレイアウトを変更するには、次の手順に従います。</p>

<ol class="bcls-tasklist-restart">
	<li><a href="#Extend_the_BrightcoveCastMediaManager">BrightCoveCastMediaManager を拡張する</a></li>
	<li><a href="#Set_the_MediaControllerConfig">MediaControllerConfig を設定する</a></li>
	<li><a href="#Overwrite_the_control_bar_setup">コントロールバーの設定を上書きする</a></li>
</ol>

<h4 id="Extend_the_BrightcoveCastMediaManager">BrightCoveCastMediaManager を拡張する</h4>

<p>のデフォルト動作を変更するには、サブクラスを作成し<code translate="No">BrightcoveCastMediaManager</code>、いくつかのキーメソッドを上書きします。</p>

<ul>
	<li>
	<pre>
<code class="language-java" translate="No">public void updateBrightcoveMediaController(boolean isRemote)</code></pre>

	<p>このメソッドは、<code translate="No">GoogleCastComponent</code>セッションが変更されたとき、つまりセッションが開始または終了したときに、によって呼び出されます。セッションが開始されると、<code translate="No">isRemote</code><code translate="No">true</code>パラメータはになり、<code translate="No">setupRemoteController</code>メソッドが呼び出されます。それ以外の場合、<code translate="No">isRemote</code><code translate="No">false</code>はになり、<code translate="No">resetToLocalController</code>が呼び出されます。</p>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">protected void setupRemoteController()</code></pre>

	<p>このメソッドはイベントを発行します<code translate="No">EventType.SET_MEDIA_CONTROLLER_CONFIG</code>とともに<code translate="No">MediaControllerConfig</code>オブジェクト。<code translate="No">MediaControllerConfig</code>このセクションの後半で詳しく説明します。このメソッドはまた、<code translate="No">BrightcoveMediaController.CONTROL_BAR_CREATED</code>イベントをリッスンし、<code translate="No">setupBrightcoveControlBar</code>メソッドを呼び出して反応します。</p>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">protected void resetToLocalController()</code></pre>

	<p>このメソッドは、を放出することにより、<code translate="No">BrightcoveMediaController</code>を元のコントローラレイアウトにリセットします<code translate="No">EventType.RESTORE_DEFAULT_MEDIA_CONTROLLER</code>。</p>
	</li>
	<li>
	<pre>
<code class="language-java" translate="No">protected void setupBrightcoveControlBar(BrightcoveControlBar controlBar)</code></pre>

	<p><code translate="No">BrightcoveMediaController</code>で提供されているレイアウトを使用してを再作成すると<code translate="No">MediaControllerConfig</code>、<code translate="No">BrightcoveControlBar</code>ビューにアクセスできます。ここから、ボタンなど UI ビューにアクセスして、<code translate="No">OnClickListener</code>ボタンに追加することができます。</p>
	</li>
</ul>

<h4 id="Set_the_MediaControllerConfig">MediaControllerConfig を設定する</h4>

<p><code translate="No">MediaControllerConfig</code>は、<code translate="No">BrightcoveMediaController</code>クラスのデフォルトのコントロールレイアウトを変更するために使用できる設定クラスです。このクラスでは、レイアウトとを設定できます<code translate="No">OnTouchListener</code>。以下に示すように、作成および設定したら、このオブジェクトを放出することができます。</p>

<pre class="line-numbers">
<code class="language-java" translate="No">Map&lt;String, Object&gt; properties = new HashMap&lt;&gt;();
properties.put(Event.MEDIA_CONTROLLER_CONFIG, myMediaControllerConfig);
eventEmitter.emit(EventType.SET_MEDIA_CONTROLLER_CONFIG,properties);</code></pre>

<p>デフォルト<code translate="No">MediaControllerConfig</code>オブジェクトはを設定します<code translate="No">R.layout.cast_media_controller</code>シングルのレイアウトとして<strong>演奏する</strong>ボタン。クリックすると、2つのオプションを持つダイアログが開きます。</p>

<ul>
	<li><strong>今すぐ再生</strong> -選択すると、<code translate="No">loadMediaInfo()</code>メソッドが呼び出され、ビデオが読み込まれ、Chromecast で再生されます。</li>
	<li><strong>キューに追加</strong> -選択すると、<code translate="No">addMediaInfo()</code>メソッドが呼び出され、ビデオがキューの最後に追加されます。</li>
</ul>

<aside class="bcls-aside bcls-aside--information">同じUIを維持したいが、キャストされているビデオに追加情報をロードしたい場合は、<code translate="No">loadMediaInfo()</code>と<code translate="No">addMediaInfo()</code>メソッド、および追加する情報をカスタマイズします<code translate="No">MediaInfo</code>物体。</aside>

<h4 id="Overwrite_the_control_bar_setup">コントロールバーの設定を上書きする</h4>

<p>を放出してメディアコントローラのレイアウトを設定すると<code translate="No">MediaControllerConfig</code>、<code translate="No">BrightcoveControlBar</code>ビューが作成され、<code translate="No">BrightcoveCastMediaManager.setupBrightcoveControlBar()</code>メソッドが呼び出されます。ここでは、IDでUIコンポーネントを取得し、適切なリスナーを追加することができます。</p>

<pre class="line-numbers">
<code class="language-java" translate="No">@Override
protected void setupBrightcoveControlBar(BrightcoveControlBar controlBar) {
   Button playButton = controlBar.findViewById(R.id.cast_play);
   if (playButton != null) {
       playButton.setOnClickListener(new View.OnClickListener() {...});
   }
}</code></pre>

</section>

<!-- <section class="bcls-section">
<h2 id="Cast_plugin_dependencies">Cast plugin dependencies</h2>

<p>The Cast plugin depends on the ExoPlayer Cast Extension:</p>

<pre>
<code class="language-java" translate="No">compile 'com.google.android.exoplayer:extension-cast:2.7.0'</code></pre>

<p>The extension have several dependencies which are listed in the table below:</p>

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th>Name</th>
			<th>Full notation and current version</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td><a href="https://developer.android.com/reference/android/support/v7/media/MediaRouter">Mediarouter v7</a></td>
			<td><code translate="No">com.android.support:mediarouter-v7:27.0.0</code></td>
		</tr>
		<tr>
			<td><a href="https://developer.android.com/topic/libraries/support-library/packages#v7">Appcompat v7</a></td>
			<td><code translate="No">com.android.support:appcompat-v7:27.0.0</code></td>
		</tr>
		<tr>
			<td><a href="https://developer.android.com/topic/libraries/support-library/packages#v4">Support v4</a></td>
			<td><code translate="No">com.android.support:support-v4:27.0.0</code></td>
		</tr>
		<tr>
			<td><a href="https://developers.google.com/android/reference/com/google/android/gms/cast/package-summary">Cast Framework</a></td>
			<td><code translate="No">com.google.android.gms:play-services-cast-framework:11.4.2</code></td>
		</tr>
		<tr>
			<td><a href="https://github.com/google/ExoPlayer/tree/release-v2/library/core">ExoPlayer Core</a></td>
			<td><code translate="No">com.google.android.exoplayer:exoplayer-core:2.7.0</code></td>
		</tr>
		<tr>
			<td><a href="https://github.com/google/ExoPlayer/tree/release-v2/library/ui">ExoPlayer UI</a></td>
			<td><code translate="No">com.google.android.exoplayer:exoplayer-ui:2.7.0</code></td>
		</tr>
	</tbody>
</table>
</section> -->

<!-- <section class="bcls-section">
<h2 id="Limitations">Limitations</h2>

<p>With the current Brightcove Native SDK for Android release, certain Video Cloud features have limited support, or are not supported when using the Cast plugin with the Google sample receiver app:</p>

<ul>
	<li>Captions
	<ul>
		<li>Only in-manifest captions with Dynamic Delivery DASH display as expected when using the Cast plugin with the Google sample receiver app.</li>
		<li>In-manifest captions with HLS and Sidecar captions in any video configuration are not currently supported when using the Cast plugin with the Google sample receiver app.</li>
	</ul>
	</li>
	<li>Widevine Modular DRM is not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Multiple Audio Tracks are not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Client-side and Server-side Advertising is not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Live and Live DVR streams are not supported when using the Cast plugin with the Google sample receiver app.</li>
	<li>Casting Offline Videos is not currently supported. When you download a video, the Source url is changed to point to a local file. If you then try casting that Video, the plugin will pick the local source but the Chromecast device will not be able to request the video.</li>
</ul>

<h3 id="Handling_currently_unsupported_features">Handling currently unsupported features</h3>

<p>The Cast plugin is responsible for gathering MediaInfo data, such as video url, title, description, and poster image, and casting it to your connected Chromecast device. Note that successful playback of the Video and display of the metadata ultimately depends on the Application Receiver.</p>

<p>It is the developer's responsibility to evaluate the Application Receiver for what it supports, and its limitations. Therefore, the developer should implement UI elements that inform the user what can or can’t be cast. For example, if the Application Receiver does not support Videos with DRM or Ads, your Android app must handle these scenarios.</p>
</section> -->

<section class="bcls-section">
<h2 id="Known_Issues">既知の問題</h2>

<h3>Android9</h3>

<p>Android 9 以降で Chromecast を使用する場合は、<code translate="No">FOREGROUND_SERVICE</code>許可を含める必要があります。これにより、アプリがバックグラウンドでフォアグラウンドに戻されたときに、アプリは通知を使用してキャストセッションを制御できます。</p>

<p>次のように、<code translate="No">uses-permission</code>タグをアプリの<strong> AndroidManifest.xml </strong>ファイルに追加する必要があります。</p>

<pre>
<code class="language-java" translate="No">&lt;uses-permission android:name="android.permission.FOREGROUND_SERVICE"/&gt;</code></pre>

<!-- <h3>Volume control</h3>

<p>The volume control in the Cast dialog may not decrease all the way to zero on the sending device. When using the volume control in the Cast dialog, or the volume buttons on the sending device, the displayed volume level may jump back up slightly to show a non-zero value on the sender. However, the receiver will display a non-zero value. This is a behavior with the Google Cast dialog, and not within the Brightcove Android SDK.</p> -->

<h4>グーグルプレイサービス</h4>

<p>送信者の Google Play サービスのバージョンが最新でない場合、キャスト接続が作成されないことがあります。送信者の Google Play サービス（特にキャストサービスフレームワークなど）が古くなると、キャスト接続の作成に失敗することがあります。これは、Google Playストアを通じて送信者のGoogle Playサービスを更新することで改善されます。</p>
</section>
</article>